<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Similarity Comparisons and Searching  | Your site_title</title>
<link rel="stylesheet" href="/RDT5/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/RDT5/css/modern-business.css">
<link rel="stylesheet" href="/RDT5/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/RDT5/css/customstyles.css">
<link rel="stylesheet" href="/RDT5/css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/RDT5/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/RDT5/js/toc.js"></script>
<script src="/RDT5/js/customscripts.js"></script>

<link rel="shortcut icon" href="/RDT5/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://YourDomainName.com/RDT5/feed.xml">




 
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/RDT5/">&nbsp;<span class="projectTitle"> Your Topnav_title</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="http://girke.bioinformatics.ucr.edu/" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">Home</a></li>
                
                
                
                <li><a href="http://manuals.bioinformatics.ucr.edu/home/programming-in-r/vim-r" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">vimR</a></li>
                
                
                
                <li><a href="http://www.genomics.ucr.edu/" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">IIGB</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Your Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/YourGitHubID/YourRepoName" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://talk.jekyllrb.com" target="_blank">Jekyll Talk</a></li>
                        
                        
                        
                        <li><a href="http://jekyllrb.com/docs/home/" target="_blank">Jekyll documentation</a></li>
                        
                        
                        
                        <li><a href="http://stackoverflow.com/questions/tagged/jekyll" target="_blank">Jekyll on Stack Overflow</a></li>
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/category-jekyll/" target="_blank">Jekyll on my blog</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li class="dropdownActive"><a href="/RDT5/">Your Home Page</a></li>
                        
                        
                        
                        <li><a href="/RDT5/p1_landing_page/">Product 1</a></li>
                        
                        
                        
                        <li><a href="/RDT5/p2_landing_page/">Product 2</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "Your site_title feedback";
var body = "I have some feedback about the Similarity Comparisons and Searching page: ";
body += window.location.href;
body += "";
var uri = "mailto:YourEmailAddress@provider.com?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/RDT5/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: '/RDT5/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Similarity Comparisons and Searching">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>
<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Your Product 1.0</li>
    
    
    
        
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="/RDT5/">Get started</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/README/">README</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Introduction</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_01/">1. Overview</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_02/">2. R Package Repositories</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_03/">3. Installation of R and Add-on Packages</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_04/">4. Getting Around</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_05/">5. Basic Syntax</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_06/">6. Data Types</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_07/">7. Data objects</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_08/">8. Important Utilities</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_09/">9. Operators and Calculations</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_10/">10. Reading and Writing External Data</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_11/">11. Useful R Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_12/">12. SQLite Databases</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_13/">13. Graphics in R</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_14/">14. Analysis Routine</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_15/">15. R Markdown</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_16/">16. Session Info</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_17/">17. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">R</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_1/">1. Overview</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_2/">2. Base Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_3/">3. Grid Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_4/">4. lattice Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_5/">5. ggplot2 Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_6/">6. Specialty Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_7/">7. Genome Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_8/">8. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">ChemmineR</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_01/">1. Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_02/">2. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_03/">3. OpenBabel Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_04/">4. Overview of Classes and Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_05/">5. Import of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_06/">6. Export of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_07/">7. Format Interconversions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_08/">8. Splitting SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_09/">9. Streaming Through Large SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_10/">10. Storing Compounds in an SQL Database</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_11/">11. Working with SDF/SDFset Classes</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_12/">12. Molecular Property Functions (Physicochemical Descriptors)</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_13/">13. Bond Matrices</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_14/">14. Charges and Missing Hydrogens</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_15/">15. Ring Perception and Aromaticity Assignment</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_16/">16. Rendering Chemical Structure Images</a></li>
            
            
            
            
            
            
            <li class="active"><a href="/RDT5/mydoc/mydoc_ChemmineR_17/">17. Similarity Comparisons and Searching</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_18/">18. Clustering</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_19/">19. Searching PubChem</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_20/">20. ChemMine Tools R Interface</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_21/">21. Version Information</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_22/">22. Funding</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_23/">23. References</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Similarity Comparisons and Searching</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/YourGithubID/YourGithubRepositoryName/blob/gh-pages//mydocmydoc_ChemmineR_17.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    

  <h2 id="maximum-common-substructure-mcs-searching">Maximum Common Substructure (MCS) Searching</h2>

<p>The <code class="highlighter-rouge">ChemmineR</code> add-on package
<a href="http://www.bioconductor.org/packages/devel/bioc/html/fmcsR.html"><code class="highlighter-rouge">fmcsR</code></a>
provides support for identifying maximum common substructures (MCSs) and
flexible MCSs among compounds. The algorithm can be used for pairwise
compound comparisons, structure similarity searching and clustering. The
manual describing this functionality is available
<a href="http://www.bioconductor.org/packages/devel/bioc/vignettes/fmcsR/inst/doc/fmcsR.html">here</a>
and the associated publication is Wang et al. (2013). The following gives a
short preview of some functionalities provided by the
<code class="highlighter-rouge">fmcsR</code> package.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">fmcsR</span><span class="p">)</span><span class="w">
 </span><span class="n">data</span><span class="p">(</span><span class="n">fmcstest</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads test sdfset object 
</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fmcs</span><span class="p">(</span><span class="n">fmcstest</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fmcstest</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">au</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">bu</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># Searches for MCS with mismatches 
</span><span class="w"> </span><span class="n">plotMCS</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plots both query compounds with MCS in color 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/plotmcs-1.png" alt="" /></p>

<h2 id="apapset-classes-for-storing-atom-pair-descriptors">AP/APset Classes for Storing Atom Pair Descriptors</h2>

<p>The function <code class="highlighter-rouge">sdf2ap</code> computes atom pair descriptors for
one or many compounds (Raymond E. Carhart et al., 1985; X. Chen , 2002). It returns a searchable atom pair database
stored in a container of class <code class="highlighter-rouge">APset</code>, which can be used
for structural similarity searching and clustering. As similarity
measure, the Tanimoto coefficient or related coefficients can be used.
An <code class="highlighter-rouge">APset</code> object consists of one or many
<code class="highlighter-rouge">AP</code> entries each storing the atom pairs of a single
compound. Note: the deprecated <code class="highlighter-rouge">cmp.parse</code> function is
still available which also generates atom pair descriptor databases, but
directly from an SD file. Since the latter function is less flexible it
may be discontinued in the future.</p>

<p>Generate atom pair descriptor database for searching:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">ap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w"> </span><span class="c1"># For single compound
</span><span class="w"> </span><span class="n">ap</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52614450304 52615497856 52615514112 52616547456 52616554624 ... length: 528
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w">
 </span><span class="c1"># For many compounds. 
</span></code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">view</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 53688190976 53688190977 53688190978 53688190979 53688190980 ... length: 528 
## 
## $`650002`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 53688190976 53688190977 53688190978 53688190979 53689239552 ... length: 325 
## 
## $`650003`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52615496704 53688190976 53688190977 53689239552 53697627136 ... length: 325 
## 
## $`650004`
## An instance of "AP"
## &lt;&lt;atom pairs&gt;&gt;
## 52617593856 52618642432 52619691008 52619691009 52628079616 ... length: 496
</code></pre>
</div>

<p>Return main components of APset objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Compound IDs 
</span><span class="w"> </span><span class="n">ap</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w"> </span><span class="c1"># Atom pair
</span><span class="w"> </span><span class="n">descriptors</span><span class="w"> 
 </span><span class="n">db.explain</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="c1"># Return atom pairs in human readable format 
</span></code></pre>
</div>

<p>Coerce APset to other objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apset2descdb</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns old list-style AP database 
</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Returns list 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="s2">"APset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Converts list back to APset 
</span></code></pre>
</div>

<h2 id="large-sdf-and-atom-pair-databases">Large SDF and Atom Pair Databases</h2>

<p>When working with large data sets it is often desirable to save the
<code class="highlighter-rouge">SDFset</code> and <code class="highlighter-rouge">APset</code> containers as binary
R objects to files for later use. This way they can be loaded very
quickly into a new R session without recreating them every time from
scratch.</p>

<p>Save and load of <code class="highlighter-rouge">SDFset</code> and <code class="highlighter-rouge">APset</code>
containers:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sdfset.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
 </span><span class="n">load</span><span class="p">(</span><span class="s2">"sdfset.rda"</span><span class="p">)</span><span class="w"> </span><span class="n">save</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"apset.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">compress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
 </span><span class="n">load</span><span class="p">(</span><span class="s2">"apset.rda"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<h2 id="pairwise-compound-comparisons-with-atom-pairs">Pairwise Compound Comparisons with Atom Pairs</h2>

<p>The <code class="highlighter-rouge">cmp.similarity</code> function computes the atom pair
similarity between two compounds using the Tanimoto coefficient as
similarity measure. The coefficient is defined as <em>c/(a+b+c)</em>, which
is the proportion of the atom pairs shared among two compounds divided
by their union. The variable <em>c</em> is the number of atom pairs common in
both compounds, while <em>a</em> and <em>b</em> are the numbers of their unique
atom pairs.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.similarity</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w">
 </span><span class="n">apset</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 0.2637037
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.similarity</span><span class="p">(</span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1
</code></pre>
</div>

<h2 id="similarity-searching-with-atom-pairs">Similarity Searching with Atom Pairs</h2>

<p>The <code class="highlighter-rouge">cmp.search</code> function searches an atom pair database
for compounds that are similar to a query compound. The following
example returns a data frame where the rows are sorted by the Tanimoto
similarity score (best to worst). The first column contains the indices
of the matching compounds in the database. The argument cutoff can be a
similarity cutoff, meaning only compounds with a similarity value larger
than this cutoff will be returned; or it can be an integer value
restricting how many compounds will be returned. When supplying a cutoff
of 0, the function will return the similarity values for every compound
in the database.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w">
 </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   index    cid    scores
## 1    61 650066 1.0000000
## 2    60 650065 1.0000000
## 3    67 650072 0.3389831
## 4    11 650011 0.3190608
## 5    15 650015 0.3184524
## 6    86 650092 0.3154270
## 7    64 650069 0.3010279
</code></pre>
</div>
<p>Alternatively, the
function can return the matches in form of an index or a named vector if
the <code class="highlighter-rouge">type</code> argument is set to <code class="highlighter-rouge">1</code> or
<code class="highlighter-rouge">2</code>, respectively.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 61 60 67 11 15 86 64
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650066    650065    650072    650011    650015    650092    650069 
## 1.0000000 1.0000000 0.3389831 0.3190608 0.3184524 0.3154270 0.3010279
</code></pre>
</div>

<h2 id="fpfpset-classes-for-storing-fingerprints">FP/FPset Classes for Storing Fingerprints</h2>

<p>The <code class="highlighter-rouge">FPset</code> class stores fingerprints of small molecules
in a matrix-like representation where every molecule is encoded as a
fingerprint of the same type and length. The <code class="highlighter-rouge">FPset</code>
container acts as a searchable database that contains the fingerprints
of many molecules. The <code class="highlighter-rouge">FP</code> container holds only one
fingerprint. Several constructor and coerce methods are provided to
populate <code class="highlighter-rouge">FP/FPset</code> containers with fingerprints, while
supporting any type and length of fingerprints. For instance, the
function <code class="highlighter-rouge">desc2fp</code> generates fingerprints from an atom
pair database stored in an <code class="highlighter-rouge">APset</code>, and
<code class="highlighter-rouge">as(matrix, "FPset")</code> and <code class="highlighter-rouge">as(character, "FPset")</code> construct an <code class="highlighter-rouge">FPset</code> database from
objects where the fingerprints are represented as
<code class="highlighter-rouge">matrix</code> or <code class="highlighter-rouge">character</code> objects,
respectively.</p>

<p>Show slots of <code class="highlighter-rouge">FPset</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">showClass</span><span class="p">(</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## Class "FPset" [package "ChemmineR"]
## 
## Slots:
##                                     
## Name:       fpma      type foldCount
## Class:    matrix character   numeric
</code></pre>
</div>

<p>Instance of <code class="highlighter-rouge">FPset</code> class:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w">
 </span><span class="n">view</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`650001`
## An instance of "FP" of type "unknown-4721"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 1024 
## 
## $`650002`
## An instance of "FP" of type "unknown-4173"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 0 1 1 ... length: 1024
</code></pre>
</div>

<p><code class="highlighter-rouge">FPset</code> class usage:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># behaves like a list 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 4 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w"> </span><span class="c1"># returns FP object 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "FP" of type "unknown-2986"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 1024
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># number of compounds ENDCOMMENT
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 100
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># returns compound ids 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   [1] "650001" "650002" "650003" "650004" "650005" "650006" "650007" "650008" "650009" "650010"
##  [11] "650011" "650012" "650013" "650014" "650015" "650016" "650017" "650019" "650020" "650021"
##  [21] "650022" "650023" "650024" "650025" "650026" "650027" "650028" "650029" "650030" "650031"
##  [31] "650032" "650033" "650034" "650035" "650036" "650037" "650038" "650039" "650040" "650041"
##  [41] "650042" "650043" "650044" "650045" "650046" "650047" "650048" "650049" "650050" "650052"
##  [51] "650054" "650056" "650058" "650059" "650060" "650061" "650062" "650063" "650064" "650065"
##  [61] "650066" "650067" "650068" "650069" "650070" "650071" "650072" "650073" "650074" "650075"
##  [71] "650076" "650077" "650078" "650079" "650080" "650081" "650082" "650083" "650085" "650086"
##  [81] "650087" "650088" "650089" "650090" "650091" "650092" "650093" "650094" "650095" "650096"
##  [91] "650097" "650098" "650099" "650100" "650101" "650102" "650103" "650104" "650105" "650106"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">10</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c1"># replacement of 10th fingerprint to all zeros 
</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># replaces compound ids 
</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">11</span><span class="o">:</span><span class="m">14</span><span class="p">])</span><span class="w"> </span><span class="c1"># concatenation of several FPset objects 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 8 molecules
</code></pre>
</div>

<p>Construct <code class="highlighter-rouge">FPset</code> class form <code class="highlighter-rouge">matrix</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># coerces FPset to matrix 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpma</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "unknown-6312" with 100 molecules
</code></pre>
</div>

<p>Construct <code class="highlighter-rouge">FPset</code> class form <code class="highlighter-rouge">character vector</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># coerces FPset to character strings 
</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpchar</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> </span><span class="c1"># construction of FPset class from character vector
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 1024 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<p>Compound similarity searching with <code class="highlighter-rouge">FPset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##         1        96        67        15 
## 1.0000000 0.4719101 0.4288499 0.4275229
</code></pre>
</div>

<p>Folding fingerprints:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># fold each FP once
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 512 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1">#fold each FP twice
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 256 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="o">=</span><span class="m">128</span><span class="p">)</span><span class="w"> </span><span class="c1">#fold each FP down to 128 bits
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 128 bit "FPset" of type "apfp" with 100 molecules
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]])</span><span class="w">  </span><span class="c1"># fold an individual FP
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "FP" of type "unknown-2996"
## &lt;&lt;fingerprint&gt;&gt;
## 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ... length: 512
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fptype</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># get type of FPs
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "apfp"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">numBits</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> </span><span class="c1"># get the number of bits of each FP
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1024
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">foldCount</span><span class="p">(</span><span class="n">fold</span><span class="p">(</span><span class="n">fpset</span><span class="p">))</span><span class="w"> </span><span class="c1"># the number of times an FP or FPset has been folded
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] 1
</code></pre>
</div>

<h2 id="atom-pair-fingerprints">Atom Pair Fingerprints</h2>

<p>Atom pairs can be converted into binary atom pair fingerprints of fixed
length. Computations on this compact data structure are more time and
memory efficient than on their relatively complex atom pair
counterparts. The function <code class="highlighter-rouge">desc2fp</code> generates
fingerprints from descriptor vectors of variable length such as atom
pairs stored in <code class="highlighter-rouge">APset</code> or <code class="highlighter-rouge">list</code>
containers. The obtained fingerprints can be used for structure
similarity comparisons, searching and clustering.</p>

<p>Create atom pair sample data set:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">sdfsample</span><span class="p">)</span><span class="w">
 </span><span class="n">sdfset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfsample</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">]</span><span class="w"> 
 </span><span class="n">apset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdf2ap</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Compute atom pair fingerprint database using internal atom pair
selection containing the 4096 most common atom pairs identified in
DrugBank’s compound collection. For details see <code class="highlighter-rouge">?apfp</code>.
The following example uses from this set the 1024 most frequent atom
pairs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Alternatively, one can provide any custom atom pair selection. Here, the
1024 most common ones in <code class="highlighter-rouge">apset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset1024</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">rev</span><span class="p">(</span><span class="n">sort</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">unlist</span><span class="p">(</span><span class="n">as</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="s2">"list"</span><span class="p">)))))[</span><span class="m">1</span><span class="o">:</span><span class="m">1024</span><span class="p">])</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">descnames</span><span class="o">=</span><span class="n">fpset1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>A more compact way of storing fingerprints is as character values:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w">
 </span><span class="n">descnames</span><span class="o">=</span><span class="m">1024</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"character"</span><span class="p">)</span><span class="w"> </span><span class="n">fpchar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Converting a fingerprint database to a matrix and vice versa:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w">
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as</span><span class="p">(</span><span class="n">fpma</span><span class="p">,</span><span class="w"> </span><span class="s2">"FPset"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Similarity searching and returning Tanimoto similarity coefficients:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Under <code class="highlighter-rouge">method</code> one can choose from several predefined
similarity measures including <em>Tanimoto</em> (default),
<em>Euclidean</em>, <em>Tversky</em> or
<em>Dice</em>. Alternatively, one can pass on custom similarity
functions.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tversky"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Example for using a custom similarity function:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">myfct</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="w">
 </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="n">myfct</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Clustering example:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">simMAap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">cid</span><span class="p">(</span><span class="n">apfpset</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">apfpset</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">apfpset</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> 
 </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">simMAap</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<h2 id="fingerprint-e-values">Fingerprint E-values</h2>
<p>The <code class="highlighter-rouge">fpSim</code> function can also return Z-scores, E-values, and p-values
if given a set of score distribution parameters. These parameters can
be computed over an <code class="highlighter-rouge">fpSet</code> with the <code class="highlighter-rouge">genParameters</code> function.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">    </span><span class="n">params</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">genParameters</span><span class="p">(</span><span class="n">fpset</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>This function will compute all pairwise distances between the given
fingerprints and then fit a Beta distribution to the resulting
Tanimoto scores, conditioned on the number of set bits in each
fingerprint. For large data sets where you would not want to compute
all pairwise distances, you can set what fraction to sample with the
<code class="highlighter-rouge">sampleFraction</code> argument. This step only needs to be done once for
each database of <code class="highlighter-rouge">fpSet</code> objects. Alternatively, if you have a large
database of fingerprints, or you believe that the parameters computed
on a single database are more generally applicable, you can use the
resulting parameters for other databases as well.</p>

<p>Once you have a set of parameters, you can pass them to <code class="highlighter-rouge">fpSim</code> with
the <code class="highlighter-rouge">parameters</code> argument.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">	</span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span><span class="w">	
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    similarity    zscore    evalue    pvalue
## 1   1.0000000 6.2418215  0.000000 0.0000000
## 96  0.4719101 1.6075792  6.748413 0.9988273
## 67  0.4288499 1.2297052 12.012285 0.9999939
## 15  0.4275229 1.2180604 12.211967 0.9999950
## 88  0.4247423 1.1936587 12.638193 0.9999968
## 64  0.4187380 1.1409688 13.594938 0.9999988
## 4   0.4166667 1.1227914 13.936692 0.9999991
## 86  0.3978686 0.9578290 17.319191 1.0000000
## 77  0.3970588 0.9507232 17.476453 1.0000000
## 69  0.3940000 0.9238806 18.079243 1.0000000
</code></pre>
</div>

<p>This will then return a data frame with the similarity, Z-score,
E-value, and p-value. You can change which value will be used as a
cutoff and to sort by by setting the argument <code class="highlighter-rouge">scoreType</code> to one of
these scores. In this way you could set an E-value cutoff of 0.04 for
example.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w">	</span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.04</span><span class="p">,</span><span class="w"> </span><span class="n">scoreType</span><span class="o">=</span><span class="s2">"evalue"</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span><span class="w">	
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   similarity   zscore evalue pvalue
## 1          1 6.241822      0      0
</code></pre>
</div>

<h2 id="pairwise-compound-comparisons-with-pubchem-fingerprints">Pairwise Compound Comparisons with PubChem Fingerprints</h2>

<p>The <code class="highlighter-rouge">fpSim</code> function computes the similarity coefficients
(<em>e.g.</em> Tanimoto) for pairwise comparisons of binary fingerprints. For
this data type, <em>c</em> is the number of “on-bits” common in both
compounds, and <em>a</em> and <em>b</em> are the numbers of their unique
“on-bits”. Currently, the PubChem fingerprints need to be provided (here
PubChem’s SD files) and cannot be computed from scratch in
<code class="highlighter-rouge">ChemmineR</code>. The PubChem fingerprint specifications can
be loaded with <code class="highlighter-rouge">data(pubchemFPencoding)</code>.</p>

<p>Convert base 64 encoded PubChem fingerprints to
<code class="highlighter-rouge">character</code> vector, <code class="highlighter-rouge">matrix</code> or
<code class="highlighter-rouge">FPset</code> object:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sdfid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w">
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fp2bit</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of a 881 bit "FPset" of type "pubchem" with 100 molecules
</code></pre>
</div>

<p>Pairwise compound structure comparisons:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650002 
## 0.5364807
</code></pre>
</div>

<h2 id="similarity-searching-with-pubchem-fingerprints">Similarity Searching with PubChem Fingerprints</h2>

<p>Similarly, the <code class="highlighter-rouge">fpSim</code> function provides search
functionality for PubChem fingerprints:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##    650065    650066    650035    650019    650012    650046 
## 1.0000000 0.9944751 0.7435897 0.7432432 0.7230047 0.7142857
</code></pre>
</div>

<h2 id="visualize-similarity-search-results">Visualize Similarity Search Results</h2>

<p>The <code class="highlighter-rouge">cmp.search</code> function allows to visualize the
chemical structures for the search results. Similar but more flexible
chemical structure rendering functions are <code class="highlighter-rouge">plot</code> and
<code class="highlighter-rouge">sdf.visualize</code> described above. By setting the visualize
argument in <code class="highlighter-rouge">cmp.search</code> to <code class="highlighter-rouge">TRUE</code>, the
matching compounds and their scores can be visualized with a standard
web browser. Depending on the <code class="highlighter-rouge">visualize.browse</code>
argument, an URL will be printed or a webpage will be opened showing the
structures of the matching compounds.</p>

<p>View similarity search results in R’s graphics device:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">sdfset</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
 </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Assure compound name consistency among objects. 
</span><span class="w">
 </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="nf">names</span><span class="p">(</span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="s2">"650065"</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/search_result-1.png" alt="" /></p>

<p>View results online with Chemmine Tools:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">similarities</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.search</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
 </span><span class="n">sdf.visualize</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="n">similarities</span><span class="p">[,</span><span class="m">1</span><span class="p">]])</span><span class="w"> 
</span></code></pre>
</div>

<div class="tags">
<b>Jump to: </b>
<a href="/RDT5/mydoc/mydoc_ChemmineR_18/" class="btn btn-default navbar-btn cursorNorm" role="button">next_page</a>
</div>


<div class="tags">
    
</div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 Your company_name. All rights reserved. <br />
<p>Page last updated:</span> Tue Jul 12 23:20:55 2016<br/> Site last generated: Jul 19, 2016 <br />
<p><img src="/RDT5/images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>

</html>