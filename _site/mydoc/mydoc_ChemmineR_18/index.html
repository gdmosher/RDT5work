<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Clustering  | Your site_title</title>
<link rel="stylesheet" href="/RDT5/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/RDT5/css/modern-business.css">
<link rel="stylesheet" href="/RDT5/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/RDT5/css/customstyles.css">
<link rel="stylesheet" href="/RDT5/css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/RDT5/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/RDT5/js/toc.js"></script>
<script src="/RDT5/js/customscripts.js"></script>

<link rel="shortcut icon" href="/RDT5/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://YourDomainName.com/RDT5/feed.xml">




 
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/RDT5/">&nbsp;<span class="projectTitle"> Your Topnav_title</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="http://girke.bioinformatics.ucr.edu/" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">Home</a></li>
                
                
                
                <li><a href="http://manuals.bioinformatics.ucr.edu/home/programming-in-r/vim-r" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">vimR</a></li>
                
                
                
                <li><a href="http://www.genomics.ucr.edu/" class="btn btn-default navbar-btn cursorNorm" role="button" target="_blank">IIGB</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Your Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/YourGitHubID/YourRepoName" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://talk.jekyllrb.com" target="_blank">Jekyll Talk</a></li>
                        
                        
                        
                        <li><a href="http://jekyllrb.com/docs/home/" target="_blank">Jekyll documentation</a></li>
                        
                        
                        
                        <li><a href="http://stackoverflow.com/questions/tagged/jekyll" target="_blank">Jekyll on Stack Overflow</a></li>
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/category-jekyll/" target="_blank">Jekyll on my blog</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Products<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li class="dropdownActive"><a href="/RDT5/">Your Home Page</a></li>
                        
                        
                        
                        <li><a href="/RDT5/p1_landing_page/">Product 1</a></li>
                        
                        
                        
                        <li><a href="/RDT5/p2_landing_page/">Product 2</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "Your site_title feedback";
var body = "I have some feedback about the Clustering page: ";
body += window.location.href;
body += "";
var uri = "mailto:YourEmailAddress@provider.com?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/RDT5/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: '/RDT5/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Clustering">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>
<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Your Product 1.0</li>
    
    
    
        
    
    <li>
        <a href="#">Overview</a>
        <ul>
            
            
            
            <li><a href="/RDT5/">Get started</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/README/">README</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Introduction</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_01/">1. Overview</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_02/">2. R Package Repositories</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_03/">3. Installation of R and Add-on Packages</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_04/">4. Getting Around</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_05/">5. Basic Syntax</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_06/">6. Data Types</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_07/">7. Data objects</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_08/">8. Important Utilities</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_09/">9. Operators and Calculations</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_10/">10. Reading and Writing External Data</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_11/">11. Useful R Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_12/">12. SQLite Databases</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_13/">13. Graphics in R</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_14/">14. Analysis Routine</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_15/">15. R Markdown</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_16/">16. Session Info</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rbasics_17/">17. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">R</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_1/">1. Overview</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_2/">2. Base Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_3/">3. Grid Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_4/">4. lattice Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_5/">5. ggplot2 Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_6/">6. Specialty Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_7/">7. Genome Graphics</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_Rgraphics_8/">8. References</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">ChemmineR</a>
        <ul>
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_01/">1. Introduction</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_02/">2. Getting Started</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_03/">3. OpenBabel Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_04/">4. Overview of Classes and Functions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_05/">5. Import of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_06/">6. Export of Compounds</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_07/">7. Format Interconversions</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_08/">8. Splitting SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_09/">9. Streaming Through Large SD Files</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_10/">10. Storing Compounds in an SQL Database</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_11/">11. Working with SDF/SDFset Classes</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_12/">12. Molecular Property Functions (Physicochemical Descriptors)</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_13/">13. Bond Matrices</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_14/">14. Charges and Missing Hydrogens</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_15/">15. Ring Perception and Aromaticity Assignment</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_16/">16. Rendering Chemical Structure Images</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_17/">17. Similarity Comparisons and Searching</a></li>
            
            
            
            
            
            
            <li class="active"><a href="/RDT5/mydoc/mydoc_ChemmineR_18/">18. Clustering</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_19/">19. Searching PubChem</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_20/">20. ChemMine Tools R Interface</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_21/">21. Version Information</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_22/">22. Funding</a></li>
            
            
            
            
            
            
            <li><a href="/RDT5/mydoc/mydoc_ChemmineR_23/">23. References</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Clustering</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/YourGithubID/YourGithubRepositoryName/blob/gh-pages//mydocmydoc_ChemmineR_18.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    

  <h2 id="clustering-identical-or-very-similar-compounds">Clustering Identical or Very Similar Compounds</h2>

<p>Often it is of interest to identify very similar or identical compounds
in a compound set. The <code class="highlighter-rouge">cmp.duplicated</code> function can be
used to quickly identify very similar compounds in atom pair sets, which
will be frequently, but not necessarily, identical compounds.</p>

<p>Identify compounds with identical AP sets:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="c1"># Returns AP duplicates as logical vector 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] FALSE FALSE FALSE FALSE
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">2</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> </span><span class="c1"># Returns AP duplicates as data frame 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##      ids CLSZ_100 CLID_100
## 1 650082        1        1
## 2 650059        2        2
## 3 650060        2        2
## 4 650010        1        3
</code></pre>
</div>

<p>Plot the structure of two pairs of duplicates:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">sdfset</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="s2">"650059"</span><span class="p">,</span><span class="s2">"650060"</span><span class="p">,</span><span class="w"> </span><span class="s2">"650065"</span><span class="p">,</span><span class="w"> </span><span class="s2">"650066"</span><span class="p">)],</span><span class="w"> </span><span class="n">print</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/duplicates-1.png" alt="" /></p>

<p>Remove AP duplicates from SDFset and APset objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">apdups</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.duplicated</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
 </span><span class="n">sdfset</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="o">!</span><span class="n">apdups</span><span class="p">)];</span><span class="w"> </span><span class="n">apset</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="o">!</span><span class="n">apdups</span><span class="p">)]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "SDFset" with 96 molecules
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## An instance of "APset" with 96 molecules
</code></pre>
</div>

<p>Alternatively, one can identify duplicates via other descriptor types if
they are provided in the data block of an imported SD file. For
instance, one can use here fingerprints, InChI, SMILES or other
molecular representations. The following examples show how to enumerate
by identical InChI strings, SMILES strings and molecular formula,
respectively.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w">
 </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_NIST_INCHI"</span><span class="p">))</span><span class="w">
 </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_OPENEYE_CAN_SMILES"</span><span class="p">))</span><span class="w"> 
 </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">datablocktag</span><span class="p">(</span><span class="n">sdfset</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">=</span><span class="s2">"PUBCHEM_MOLECULAR_FORMULA"</span><span class="p">))</span><span class="w"> 
 </span><span class="n">count</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
##  C10H9FN2O2S   C11H12N4OS    C11H13NO4 C12H11ClN2OS 
##            1            1            1            1
</code></pre>
</div>

<h2 id="binning-clustering">Binning Clustering</h2>

<p>Compound libraries can be clustered into discrete similarity groups with
the binning clustering function <code class="highlighter-rouge">cmp.cluster</code>. The
function accepts as input an atom pair (<code class="highlighter-rouge">APset</code>) or a
fingerprint (<code class="highlighter-rouge">FPset</code>) descriptor database as well as a
similarity threshold. The binning clustering result is returned in form
of a data frame. Single linkage is used for cluster joining. The
function calculates the required compound-to-compound distance
information on the fly, while a memory-intensive distance matrix is only
created upon user request via the <code class="highlighter-rouge">save.distances</code>
argument (see below).</p>

<p>Because an optimum similarity threshold is often not known, the
<code class="highlighter-rouge">cmp.cluster</code> function can calculate cluster results for
multiple cutoffs in one step with almost the same speed as for a single
cutoff. This can be achieved by providing several cutoffs under the
cutoff argument. The clustering results for the different cutoffs will
be stored in one data frame.</p>

<p>One may force the <code class="highlighter-rouge">cmp.cluster</code> function to calculate and
store the distance matrix by supplying a file name to the
<code class="highlighter-rouge">save.distances</code> argument. The generated distance matrix
can be loaded and passed on to many other clustering methods available
in R, such as the hierarchical clustering function
<code class="highlighter-rouge">hclust</code> (see below).</p>

<p>If a distance matrix is available, it may also be supplied to
<code class="highlighter-rouge">cmp.cluster</code> via the <code class="highlighter-rouge">use.distances</code>
argument. This is useful when one has a pre-computed distance matrix
either from a previous call to <code class="highlighter-rouge">cmp.cluster</code> or from
other distance calculation subroutines.</p>

<p>Single-linkage binning clustering with one or multiple cutoffs:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##       ids CLSZ_0.7 CLID_0.7 CLSZ_0.8 CLID_0.8 CLSZ_0.9 CLID_0.9
## 48 650049        2       48        2       48        2       48
## 49 650050        2       48        2       48        2       48
## 54 650059        2       54        2       54        2       54
## 55 650060        2       54        2       54        2       54
## 56 650061        2       56        2       56        2       56
## 57 650062        2       56        2       56        2       56
## 58 650063        2       58        2       58        2       58
## 59 650064        2       58        2       58        2       58
## 60 650065        2       60        2       60        2       60
## 61 650066        2       60        2       60        2       60
## 1  650001        1        1        1        1        1        1
## 2  650002        1        2        1        2        1        2
</code></pre>
</div>

<p>Clustering of <code class="highlighter-rouge">FPset</code> objects with multiple cutoffs. This
method allows to call various similarity methods provided by the
<code class="highlighter-rouge">fpSim</code> function. For details consult
<code class="highlighter-rouge">?fpSim</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w">
 </span><span class="n">clusters2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters2</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##       ids CLSZ_0.5 CLID_0.5 CLSZ_0.7 CLID_0.7 CLSZ_0.9 CLID_0.9
## 69 650074       14       11        2       69        1       69
## 79 650085       14       11        2       69        1       79
## 11 650011       14       11        1       11        1       11
## 15 650015       14       11        1       15        1       15
## 45 650046       14       11        1       45        1       45
## 47 650048       14       11        1       47        1       47
## 51 650054       14       11        1       51        1       51
## 53 650058       14       11        1       53        1       53
## 64 650069       14       11        1       64        1       64
## 65 650070       14       11        1       65        1       65
## 67 650072       14       11        1       67        1       67
## 86 650092       14       11        1       86        1       86
</code></pre>
</div>

<p>Sames as above, but using Tversky similarity measure:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> 
								  </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tversky"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="o">=</span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<p>Return cluster size distributions for each cutoff:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.sizestat</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">cluster.result</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##   cluster size count
## 1            1    90
## 2            2     5
</code></pre>
</div>

<p>Enforce calculation of distance matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">clusters</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.65</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.3</span><span class="p">),</span><span class="w">
 </span><span class="n">save.distances</span><span class="o">=</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Saves distance matrix to file "distmat.rda" in current working directory. 
</span><span class="w"> </span><span class="n">load</span><span class="p">(</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Loads distance matrix. 
</span></code></pre>
</div>

<h2 id="jarvis-patrick-clustering">Jarvis-Patrick Clustering</h2>

<p>The Jarvis-Patrick clustering algorithm is widely used in
cheminformatics (R.A. Jarvis , 1973). It requires a nearest neighbor table, which consists
of <em>j</em> nearest neighbors for each item (<em>e.g.</em> compound).
The nearest neighbor table is then used to join items into clusters when
they meet the following requirements: (a) they are contained in each
other’s neighbor list and (b) they share at least <em>k</em>
nearest neighbors. The values for <em>j</em> and
<em>k</em> are user-defined parameters. The
<code class="highlighter-rouge">jarvisPatrick</code> function implemented in
<code class="highlighter-rouge">ChemmineR</code> takes a nearest neighbor table generated by
<code class="highlighter-rouge">nearestNeighbors</code>, which works for
<code class="highlighter-rouge">APset</code> and <code class="highlighter-rouge">FPset</code> objects. This function
takes either the standard Jarvis-Patrick <em>j</em> parameter
(as the <code class="highlighter-rouge">numNbrs</code> parameter), or else a
<code class="highlighter-rouge">cutoff</code> value, which is an extension to the basic
algorithm that we have added. Given a cutoff value, the nearest neighbor
table returned contains every neighbor with a similarity greater than
the cutoff value, for each item. This allows one to generate tighter
clusters and to minimize certain limitations of this method, such as
false joins of completely unrelated items when operating on small data
sets. The <code class="highlighter-rouge">trimNeighbors</code> function can also be used to
take an existing nearest neighbor table and remove all neighbors whose
similarity value is below a given cutoff value. This allows one to
compute a very relaxed nearest neighbor table initially, and then
quickly try different refinements later.</p>

<p>In case an existing nearest neighbor matrix needs to be used, the
<code class="highlighter-rouge">fromNNMatrix</code> function can be used to transform it into
the list structure that <code class="highlighter-rouge">jarvisPatrick</code> requires. The
input matrix must have a row for each compound, and each row should be
the index values of the neighbors of compound represented by that row.
The names of each compound can also be given through the
<code class="highlighter-rouge">names</code> argument. If not given, it will attempt to use
the <code class="highlighter-rouge">rownames</code> of the given matrix.</p>

<p>The <code class="highlighter-rouge">jarvisPatrick</code> function also allows one to relax
some of the requirements of the algorithm through the
<code class="highlighter-rouge">mode</code> parameter. When set to “a1a2b”, then all
requirements are used. If set to “a1b”, then (a) is relaxed to a
unidirectional requirement. Lastly, if <code class="highlighter-rouge">mode</code> is set to
“b”, then only requirement (b) is used, which means that all pairs of
items will be checked to see if (b) is satisfied between them. The size
of the clusters generated by the different methods increases in this
order: “a1a2b” &lt; “a1b” &lt; “b”. The run time of method “a1a2b” follows a
close to linear relationship, while it is nearly quadratic for the much
more exhaustive method “b”. Only methods “a1a2b” and “a1b” are suitable
for clustering very large data sets (e.g. &gt;50,000 items) in a
reasonable amount of time.</p>

<p>An additional extension to the algorithm is the ability to set the
linkage mode. The <code class="highlighter-rouge">linkage</code> parameter can be one of
“single”, “average”, or “complete”, for single linkage, average linkage
and complete linkage merge requirements, respectively. In the context of
Jarvis-Patrick, average linkage means that at least half of the pairs
between the clusters under consideration must meet requirement (b).
Similarly, for complete linkage, all pairs must requirement (b). Single
linkage is the normal case for Jarvis-Patrick and just means that at
least one pair must meet requirement (b).</p>

<p>The output is a cluster <code class="highlighter-rouge">vector</code> with the item labels in
the name slot and the cluster IDs in the data slot. There is a utility
function called <code class="highlighter-rouge">byCluster</code>, which takes out cluster
vector output by <code class="highlighter-rouge">jarvisPatrick</code> and transforms it into a
list of vectors. Each slot of the list is named with a cluster id and
the vector contains the cluster members. By default the function
excludes singletons from the output, but they can be included by setting
<code class="highlighter-rouge">excludeSingletons</code>=FALSE`.</p>

<p>Load/create sample <code class="highlighter-rouge">APset</code> and <code class="highlighter-rouge">FPset</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
 </span><span class="n">fpset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">desc2fp</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Standard Jarvis-Patrick clustering on <code class="highlighter-rouge">APset</code> and
<code class="highlighter-rouge">FPset</code> objects:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"a1a2b"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     44     45     46     47     48     49     50     51     52     53     54     55 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     56     57     58     59     60     61     62     63     64     65     66     67     68     69 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     70     71     72     73     74     75     76     77     78     79     80     81     82     83 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     84     85     86     87     88     89     90     91     92     93     94     95     96     97 
## 650105 650106 
##     98     99
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1">#Using "APset" 
</span><span class="w">
 </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"a1a2b"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     44     45     46     47     48     49     50     51     52     53     54     55 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     56     57     58     59     60     61     62     63     64     65     66     67     68     69 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     70     71     72     73     74     75     76     77     78     79     80     81     82     83 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     84     85     86     87     88     89     90     91     92     93     94      1     95     96 
## 650105 650106 
##     97     98
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="c1">#Using "FPset" 
</span></code></pre>
</div>

<p>The following example runs Jarvis-Patrick clustering with a minimum
similarity <code class="highlighter-rouge">cutoff</code> value (here Tanimoto coefficient). In
addition, it uses the much more exhaustive <code class="highlighter-rouge">"b"</code> method
that generates larger cluster sizes, but significantly increased the run
time. For more details, consult the corresponding help file with
<code class="highlighter-rouge">?jarvisPatrick</code>.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cl</span><span class="o">&lt;-</span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span><span class="w">
 </span><span class="n">method</span><span class="o">=</span><span class="s2">"Tanimoto"</span><span class="p">),</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span><span class="w">
 </span><span class="n">byCluster</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`11`
## [1] "650011" "650092"
## 
## $`15`
## [1] "650015" "650069"
## 
## $`45`
## [1] "650046" "650054"
## 
## $`48`
## [1] "650049" "650050"
## 
## $`52`
## [1] "650059" "650060"
## 
## $`53`
## [1] "650061" "650062"
## 
## $`54`
## [1] "650063" "650064"
## 
## $`55`
## [1] "650065" "650066"
## 
## $`62`
## [1] "650074" "650085"
</code></pre>
</div>

<p>Output nearest neighbor table (<code class="highlighter-rouge">matrix</code>):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nearestNeighbors</span><span class="p">(</span><span class="n">fpset</span><span class="p">,</span><span class="n">numNbrs</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w">
 </span><span class="n">nnm</span><span class="o">$</span><span class="n">names</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## [1] "650001" "650002" "650003" "650004"
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="o">$</span><span class="n">ids</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## NULL
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="o">$</span><span class="n">similarities</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     650001    650102    650072    650015    650094    650069
## sim      1 0.4719101 0.4288499 0.4275229 0.4247423 0.4187380
## sim      1 0.4343891 0.4246575 0.4216867 0.3939394 0.3922078
## sim      1 0.4152249 0.3619303 0.3610315 0.3424242 0.3367089
## sim      1 0.5791045 0.4973958 0.4192708 0.4166667 0.4104683
</code></pre>
</div>

<p>Trim nearest neighbor table:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nnm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trimNeighbors</span><span class="p">(</span><span class="n">nnm</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="m">0.4</span><span class="p">)</span><span class="w"> 
 </span><span class="n">nnm</span><span class="o">$</span><span class="n">similarities</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,]</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     650001    650102    650072    650015    650094    650069
## sim      1 0.4719101 0.4288499 0.4275229 0.4247423 0.4187380
## sim      1 0.4343891 0.4246575 0.4216867        NA        NA
## sim      1 0.4152249        NA        NA        NA        NA
## sim      1 0.5791045 0.4973958 0.4192708 0.4166667 0.4104683
</code></pre>
</div>

<p>Perform clustering on precomputed nearest neighbor table:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">nnm</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 650001 650002 650003 650004 650005 650006 650007 650008 650009 650010 650011 650012 650013 650014 
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14 
## 650015 650016 650017 650019 650020 650021 650022 650023 650024 650025 650026 650027 650028 650029 
##     11     15     16     17     18     19     20     21     22     23     24     25     26     27 
## 650030 650031 650032 650033 650034 650035 650036 650037 650038 650039 650040 650041 650042 650043 
##     28     29     30     31     32     33     34     35     36     37     38     39     40     41 
## 650044 650045 650046 650047 650048 650049 650050 650052 650054 650056 650058 650059 650060 650061 
##     42     43     11     44     11     45     46     47     48     49     50     51     52     53 
## 650062 650063 650064 650065 650066 650067 650068 650069 650070 650071 650072 650073 650074 650075 
##     54     55     56     57     57     58     59     11     60     61     62     63     64     65 
## 650076 650077 650078 650079 650080 650081 650082 650083 650085 650086 650087 650088 650089 650090 
##     66     67     68     69     37     70     71     72     64     73     74     75     76     77 
## 650091 650092 650093 650094 650095 650096 650097 650098 650099 650100 650101 650102 650103 650104 
##     78     11     79     80     81     82     83     84     85     86     87      1     88     89 
## 650105 650106 
##     90     91
</code></pre>
</div>

<p>Using a user defined nearest neighbor matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="n">dimnames</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s1">'one'</span><span class="p">,</span><span class="s1">'two'</span><span class="p">)))</span><span class="w"> 
 </span><span class="n">nn</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>##     [,1] [,2]
## one    1    2
## two    2    1
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">byCluster</span><span class="p">(</span><span class="n">jarvisPatrick</span><span class="p">(</span><span class="n">fromNNMatrix</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## $`1`
## [1] "one" "two"
</code></pre>
</div>

<h2 id="multi-dimensional-scaling-mds">Multi-Dimensional Scaling (MDS)</h2>

<p>To visualize and compare clustering results, the
<code class="highlighter-rouge">cluster.visualize</code> function can be used. The function
performs Multi-Dimensional Scaling (MDS) and visualizes the results in
form of a scatter plot. It requires as input an <code class="highlighter-rouge">APset</code>,
a clustering result from <code class="highlighter-rouge">cmp.cluster</code>, and a cutoff for
the minimum cluster size to consider in the plot. To help determining a
proper cutoff size, the <code class="highlighter-rouge">cluster.sizestat</code> function is
provided to generate cluster size statistics.</p>

<p>MDS clustering and scatter plot:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">size.cutoff</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Color codes clusters with at least two members. 
</span><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># Plots all items.
</span></code></pre>
</div>

<p>Create a 3D scatter plot of MDS result:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">scatterplot3d</span><span class="p">)</span><span class="w"> 
 </span><span class="n">coord</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cluster.visualize</span><span class="p">(</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">clusters</span><span class="p">,</span><span class="w"> </span><span class="n">size.cutoff</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
 </span><span class="n">scatterplot3d</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/mds_scatter-1.png" alt="" /></p>

<p>Interactive 3D scatter plot with Open GL (graphics not evaluated here):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">rgl</span><span class="p">)</span><span class="w"> </span><span class="n">rgl.open</span><span class="p">();</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="p">;</span><span class="w">
 </span><span class="n">par3d</span><span class="p">(</span><span class="n">windowRect</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="m">640</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="m">640</span><span class="o">+</span><span class="n">offset</span><span class="p">))</span><span class="w"> 
 </span><span class="n">rm</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span><span class="w">
 </span><span class="n">rgl.clear</span><span class="p">()</span><span class="w"> 
 </span><span class="n">rgl.viewpoint</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="o">=</span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">fov</span><span class="o">=</span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="n">zoom</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w">
 </span><span class="n">spheres3d</span><span class="p">(</span><span class="n">coord</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">coord</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">coord</span><span class="p">[,</span><span class="m">3</span><span class="p">],</span><span class="w"> </span><span class="n">radius</span><span class="o">=</span><span class="m">0.03</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">coord</span><span class="p">[,</span><span class="m">4</span><span class="p">],</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">shininess</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w"> 
 </span><span class="n">aspect3d</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> 
 </span><span class="n">axes3d</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w">
 </span><span class="n">title3d</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span><span class="w">
 </span><span class="n">bg3d</span><span class="p">(</span><span class="s2">"white"</span><span class="p">)</span><span class="w"> </span><span class="c1"># To save a snapshot of the graph, one can use the command rgl.snapshot("test.png").
</span></code></pre>
</div>

<h2 id="clustering-with-other-algorithms">Clustering with Other Algorithms</h2>

<p><code class="highlighter-rouge">ChemmineR</code> allows the user to take advantage of the wide
spectrum of clustering utilities available in R. An example on how to
perform hierarchical clustering with the hclust function is given
below.</p>

<p>Create atom pair distance matrix:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">dummy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cmp.cluster</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">apset</span><span class="p">,</span><span class="w"> </span><span class="n">cutoff</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">save.distances</span><span class="o">=</span><span class="s2">"distmat.rda"</span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## sorting result...
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">load</span><span class="p">(</span><span class="s2">"distmat.rda"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Hierarchical clustering with <code class="highlighter-rouge">hclust</code>:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="n">distmat</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">hc</span><span class="p">[[</span><span class="s2">"labels"</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cid</span><span class="p">(</span><span class="n">apset</span><span class="p">)</span><span class="w"> </span><span class="c1"># Assign correct item labels 
</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/hclust-1.png" alt="" /></p>

<p>Instead of atom pairs one can use PubChem’s fingerprints for clustering:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">simMA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">cid</span><span class="p">(</span><span class="n">fpset</span><span class="p">),</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">fpSim</span><span class="p">(</span><span class="n">fpset</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">fpset</span><span class="p">,</span><span class="w"> </span><span class="n">sorted</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w">
 </span><span class="n">hc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">simMA</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">plot</span><span class="p">(</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">edgePar</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">horiz</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p>Plot dendrogram with heatmap (here similarity matrix):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">gplots</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## 
## Attaching package: 'gplots'
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## The following object is masked from 'package:stats':
## 
##     lowess
</code></pre>
</div>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="w"> </span><span class="n">heatmap.2</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">distmat</span><span class="p">,</span><span class="w"> </span><span class="n">Rowv</span><span class="o">=</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> </span><span class="n">Colv</span><span class="o">=</span><span class="n">as.dendrogram</span><span class="p">(</span><span class="n">hc</span><span class="p">),</span><span class="w"> 
			  </span><span class="n">col</span><span class="o">=</span><span class="n">colorpanel</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="s2">"darkblue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w"> 
			  </span><span class="n">density.info</span><span class="o">=</span><span class="s2">"none"</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span><span class="w"> 
</span></code></pre>
</div>

<p><img src="../ChemmineR_files/heatmap-1.png" alt="" /></p>

<div class="tags">
<b>Jump to: </b>
<a href="/RDT5/mydoc/mydoc_ChemmineR_19/" class="btn btn-default navbar-btn cursorNorm" role="button">next_page</a>
</div>


<div class="tags">
    
</div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 Your company_name. All rights reserved. <br />
<p>Page last updated:</span> Tue Jul 12 23:20:55 2016<br/> Site last generated: Jul 19, 2016 <br />
<p><img src="/RDT5/images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>

</html>